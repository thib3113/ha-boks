<!DOCTYPE html>
<html>
<head>
    <title>Boks Update Portal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #03a9f4;
            --primary-dark: #0288d1;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-secondary: #666666;
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            padding: 20px; 
            background: var(--bg-color); 
            color: var(--text-color); 
            line-height: 1.5;
        }
        .card { 
            background: var(--card-bg); 
            padding: 24px; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            max-width: 500px; 
            margin: 0 auto; 
        }
        h1 { 
            font-size: 1.5rem; 
            margin-top: 0; 
            color: #2c3e50;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .version-list { list-style: none; padding: 0; margin: 0; }
        .version-item { 
            margin-bottom: 12px; 
            border: 1px solid #eee; 
            padding: 16px; 
            border-radius: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .version-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            border-color: var(--primary-color);
        }
        .version-link { 
            display: block; 
            text-decoration: none; 
            color: var(--primary-color); 
            font-weight: 700; 
            font-size: 1.2rem; 
            margin-bottom: 4px;
        }
        .version-info { 
            font-size: 0.85rem; 
            color: var(--text-secondary); 
        }
        #loading { text-align: center; color: var(--text-secondary); padding: 20px; }
        .empty-state { text-align: center; color: var(--text-secondary); padding: 40px 20px; }
    </style>
</head>
<body>
    <div class="card">
        <h1>Available Boks Updates</h1>
        <div id="status-area">
            <div id="loading">Loading versions...</div>
        </div>
        <ul id="list" class="version-list"></ul>
    </div>

    <script>
        const list = document.getElementById('list');
        const statusArea = document.getElementById('status-area');

        async function loadVersions() {
            try {
                const response = await fetch('versions.json');
                if (!response.ok) throw new Error('Catalog not found');
                const data = await response.json();
                
                statusArea.style.display = 'none';
                
                const versionKeys = Object.keys(data.versions || {});
                if (versionKeys.length === 0) {
                    statusArea.innerHTML = '<div class="empty-state">No firmware updates available yet.</div>';
                    statusArea.style.display = 'block';
                    return;
                }

                // Sort versions descending (numeric)
                versionKeys.sort((a, b) => b.localeCompare(a, undefined, {numeric: true, sensitivity: 'base'}));
                
                versionKeys.forEach(v => {
                    const info = data.versions[v];
                    const li = document.createElement('li');
                    li.className = 'version-item';
                    li.innerHTML = `
                        <a class="version-link" href="${info.path}">Version ${v}</a>
                        <div class="version-info">
                            <strong>Hardware:</strong> ${info.chipset}<br>
                            <strong>Revision:</strong> ${info.internal_rev}
                        </div>
                    `;
                    list.appendChild(li);
                });
            } catch (err) {
                statusArea.innerHTML = '<div class="empty-state" style="color: #f44336">Error loading firmware catalog.</div>';
                console.error('Portal Error:', err);
            }
        }

        loadVersions();
    </script>
</body>
</html>
